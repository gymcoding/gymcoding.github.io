(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{470:function(s,t,a){"use strict";a.r(t);var e=a(7),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"들어가며"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#들어가며"}},[s._v("#")]),s._v(" 들어가며")]),s._v(" "),a("p",[s._v("지난 포스팅을 통하여 "),a("RouterLink",{attrs:{to:"/_posts/2020-9-22-mqtt-eclipse-mosquitto.html"}},[s._v("MQTT Broker 설치")]),s._v("를 완료했다. 다른 서버도 마찬가지지만 Broker 서버에 메시지 발행(Publish)이나 구독(Subscribe)시에 인증(Authentication)되지 않은 클라이언트의 요청은 차단해야한다. 이번 포스팅에서는 "),a("a",{attrs:{href:"https://mosquitto.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mosquitto Eclipse MQTT 오픈소스"),a("OutboundLink")],1),s._v("를 활용하여 Broker username/password기반 인증(Authentication)하는 방법에 대해 알아보자.")],1),s._v(" "),a("h2",{attrs:{id:"mosquitto-passwd란"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mosquitto-passwd란"}},[s._v("#")]),s._v(" mosquitto_passwd란?")]),s._v(" "),a("p",[s._v("mosquitto_passwd는 mosquitto MQTT 브로커의 비밀번호 파일을 관리하기위한 도구입니다.\nusername 생성시 "),a("code",[s._v(":")]),s._v("가 포함되지 않아야합니다.")]),s._v(" "),a("h2",{attrs:{id:"인증설정"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#인증설정"}},[s._v("#")]),s._v(" 인증설정")]),s._v(" "),a("p",[s._v("mosquitto_passwd 도구로 새로운 사용자를 추가(파일)하고 새롭게 생성된 파일을 mosquitto.conf파일에 적용해보자.")]),s._v(" "),a("h4",{attrs:{id:"_1-새로운-비밀번호-파일에-사용자-추가"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-새로운-비밀번호-파일에-사용자-추가"}},[s._v("#")]),s._v(" 1. 새로운 비밀번호 파일에 사용자 추가")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mosquitto_passwd -c /etc/mosquitto/passwd ral\n")])])]),a("ul",[a("li",[s._v("passwd 파일명의 새로운 비밀번호 파일이 생성됩니다.")]),s._v(" "),a("li",[s._v("passwd 파일안에 ral사용자와 암호화된 비밀번호가 추가되었습니다.")])]),s._v(" "),a("h4",{attrs:{id:"_2-mosquitto-conf-파일-속성변경"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-mosquitto-conf-파일-속성변경"}},[s._v("#")]),s._v(" 2. mosquitto.conf 파일 속성변경")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/mosquitto/config/mosquitto.conf\n")])])]),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mosquitto.conf file")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\nallow_anonymous "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 추가")]),s._v("\npassword_file /etc/mosquitto/passwd "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 추가")]),s._v("\n")])])]),a("h4",{attrs:{id:"_3-mosquitto-재시작"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-mosquitto-재시작"}},[s._v("#")]),s._v(" 3. mosquitto 재시작")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -c 옵션은 환경설정 파일 경로이며 default는 mosquitto.conf이다.")]),s._v("\nmosquitto -c /etc/mosquitto/config/mosquitto.conf -v \n")])])]),a("ul",[a("li",[s._v("[참고] Broker가 Docker Container인 경우 Container를 재시작 해야할 수 있다.")]),s._v(" "),a("li",[s._v("[참고] Docker 재시작시 passwd파일이 날라가지 않도록 주의하자. (Volumn 설정)")])]),s._v(" "),a("h2",{attrs:{id:"옵션"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#옵션"}},[s._v("#")]),s._v(" 옵션")]),s._v(" "),a("h3",{attrs:{id:"b"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#b"}},[s._v("#")]),s._v(" -b")]),s._v(" "),a("ul",[a("li",[s._v("배치 모드로 실행합니다. 이렇게하면 편리 할 수있는 명령 줄에서 암호를 제공 할 수 있지만 암호는 명령 줄과 명령 기록에서 볼 수 있으므로주의해서 사용해야합니다.")])]),s._v(" "),a("h3",{attrs:{id:"c"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c"}},[s._v("#")]),s._v(" -c")]),s._v(" "),a("ul",[a("li",[s._v("새 암호 파일을 만듭니다. 파일이 이미 있으면 덮어 씁니다.")])]),s._v(" "),a("h3",{attrs:{id:"d"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#d"}},[s._v("#")]),s._v(" -D")]),s._v(" "),a("ul",[a("li",[s._v("비밀번호 파일에서 지정된 사용자를 삭제하십시오.")])]),s._v(" "),a("h3",{attrs:{id:"u"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#u"}},[s._v("#")]),s._v(" -U")]),s._v(" "),a("ul",[a("li",[s._v("이 옵션은 일반 텍스트 암호가있는 암호 파일을 해시 된 암호를 사용하는 파일로 업그레이드 / 변환하는 데 사용할 수 있습니다. 지정된 파일을 수정합니다. 암호가 이미 해시되었는지 여부를 감지하지 않으므로 이미 해시 된 암호가 포함 된 암호 파일에서 암호를 사용하면 이전 해시를 기반으로 새 해시가 생성되고 암호 파일을 사용할 수 없게됩니다.")])]),s._v(" "),a("h2",{attrs:{id:"예시"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#예시"}},[s._v("#")]),s._v(" 예시")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("새로운 비밀번호 파일에 사용자 추가")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mosquitto_passwd -c /etc/mosquitto/passwd ral\n")])])])]),s._v(" "),a("li",[a("p",[s._v("기존 비밀번호 파일에 사용자 추가")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mosquitto_passwd -b /etc/mosquitto/passwd "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("암호 파일에서 사용자 삭제")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mosquitto_passwd -c /etc/mosquitto/passwd ral\n")])])])])]),s._v(" "),a("p",[s._v("지금까지 mosquitto broker의 username/password기반 인증설정 방법을 알아보았다.")])])}),[],!1,null,null,null);t.default=r.exports}}]);